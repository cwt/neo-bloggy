<!DOCTYPE html>
<html lang="en">
   <head>
      <!-- META TAGS -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      
      {% if post %}
      <!-- Post-specific meta tags -->
      <meta name="description" content="{{ post.subtitle or post.title }}">
      <meta name="author" content="{{ post.author }}">
      <meta name="keywords" content="{{ post.title }}, {{ post.author }}, blog, article">
      
      <!-- Open Graph / Facebook -->
      <meta property="og:type" content="article">
      <meta property="og:url" content="{{ url_for('show_post', post_id=post._id, _external=True) }}">
      <meta property="og:title" content="{{ post.title }}">
      <meta property="og:description" content="{{ post.subtitle or post.title[:160] }}">
      {% if post.img_url %}
      <meta property="og:image" content="{{ post.img_url }}">
      {% endif %}
      
      <!-- Twitter -->
      <meta property="twitter:card" content="summary_large_image">
      <meta property="twitter:url" content="{{ url_for('show_post', post_id=post._id, _external=True) }}">
      <meta property="twitter:title" content="{{ post.title }}">
      <meta property="twitter:description" content="{{ post.subtitle or post.title[:160] }}">
      {% if post.img_url %}
      <meta property="twitter:image" content="{{ post.img_url }}">
      {% endif %}
      
      <!-- Article schema -->
      <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "{{ post.title }}",
        "author": {
          "@type": "Person",
          "name": "{{ post.author }}"
        },
        "datePublished": "{{ post.date }}",
        "description": "{{ post.subtitle or post.title }}",
        {% if post.img_url %}
        "image": "{{ post.img_url }}",
        {% endif %}
        "publisher": {
          "@type": "Organization",
          "name": "{{ site_title }}",
          "logo": {
            "@type": "ImageObject",
            "url": "{{ url_for('static', filename='img/webp/logo.webp', _external=True) }}"
          }
        }
      }
      </script>
      
      <title>{{ post.title }} - {{ site_title }}</title>
      {% else %}
      <!-- Default meta tags -->
      <meta name="description" content="{{ site_description }}">
      <meta name="author" content="{{ site_author }}">
      <meta name="keywords" content="blog, articles, {{ site_title }}">
      
      <!-- Open Graph / Facebook -->
      <meta property="og:type" content="website">
      <meta property="og:url" content="{{ request.url }}">
      <meta property="og:title" content="{{ site_title }}">
      <meta property="og:description" content="{{ site_description }}">
      <meta property="og:image" content="{{ url_for('static', filename='img/webp/logo.webp', _external=True) }}">
      
      <!-- Twitter -->
      <meta property="twitter:card" content="summary_large_image">
      <meta property="twitter:url" content="{{ request.url }}">
      <meta property="twitter:title" content="{{ site_title }}">
      <meta property="twitter:description" content="{{ site_description }}">
      <meta property="twitter:image" content="{{ url_for('static', filename='img/webp/logo.webp', _external=True) }}">
      
      <title>{{ site_title }}</title>
      {% endif %}
      
      <!-- Canonical URL -->
      <link rel="canonical" href="{{ request.url }}">

       <!-- FAVICON -->
      <link rel="icon" type="image/webp" href="{{ url_for('static', filename='img/webp/favicon.webp')}}">
      
      <!-- Canonical URL -->
      <link rel="canonical" href="{{ request.url }}">

       <!-- CSS -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.1/css/all.css" integrity="sha384-t1nt8BQoYMLFN5p42tRAtuAAFQaCQODekUVeKKZrEnEyp4H2R0RHFz0KWpmj7i8g" crossorigin="anonymous">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/easymde@2.18.0/dist/easymde.min.css">

       <!-- CUSTOM STYLE -->
      <link href="{{ url_for('static', filename='css/pygments.css', v='1.1')}}" rel="stylesheet">
      <link href="{{ url_for('static', filename='css/style.css')}}" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
   </head>
   <body>

      <!-- NAVIGATION -->
      <header>
         <nav class="navbar navbar-expand-md navbar-light fixed-top bg-light">
            <div class="container">
               <a class="navbar-brand" href="{{url_for('get_all_posts')}}"><img src="/static/img/webp/logo.webp" alt="{{ site_title }} Logo" height="48"></a>
               <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
               </button>
               <div class="collapse navbar-collapse" id="navbarResponsive">
                  <ul class="navbar-nav ms-auto align-items-center">
                     <li class="nav-item">
                        <form class="d-flex" role="search" action="{{ url_for('search') }}" method="POST">
                           <input class="form-control me-2" type="search" name="query" placeholder="Search all posts..." value="{{ search_query or '' }}" aria-label="Search">
                           <button class="btn btn-dark" type="submit">Search</button>
                           <a class="btn btn-outline-info ms-2" href="{{ url_for('get_all_posts') }}" role="button">Reset</a>
                        </form>
                     </li>
                     {% if not session.user %}
                     <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('login') }}">Sign In</a>
                     </li>
                     <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('register') }}">Get Started</a>
                     </li>
                     {% else: %}
                     <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('create_post') }}">Write</a>
                     </li>
                     <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('upload_image') }}">Upload Image</a>
                     </li>
                     {% if user and user.is_admin %}
                     <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('admin_panel') }}">Admin Panel</a>
                     </li>
                     {% endif %}
                     <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logout') }}">Log Out</a>
                     </li>
                     <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('profile', username=session['user']) }}">Profile</a>
                     </li>
                     {% endif %}
                  </ul>
               </div>
            </div>
         </nav>
      </header>