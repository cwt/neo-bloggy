{% include "header.html" %}

<main role="main">
   <div class="jumbotron profile-jumbotron">
      <div class="container" style="position: relative;">
         <h1 class="display-2">{{ username.title() }}'s Profile</h1>
         <hr class="my-4">
         <p>Manage your posts and comments.</p>
         {% if user and user.is_admin %}
         <span class="badge bg-primary" style="position: absolute; top: 1rem; right: 1rem;">Administrator</span>
         {% endif %}
         {% if user and not user.is_active %}
         <span class="badge bg-danger" style="position: absolute; top: 3rem; right: 1rem;">Account Disabled</span>
         {% endif %}
         <a href="{{ url_for('edit_profile') }}" class="btn btn-primary" style="position: absolute; bottom: 1rem; right: 1rem;">Edit Profile</a>
      </div>
   </div>
   
   {% with breadcrumb_items=[{'name': 'Home', 'url': url_for('get_all_posts')}, {'name': username.title() ~ "'s Profile", 'url': '#'}] %}
      {% include "breadcrumb.html" %}
   {% endwith %}
   <div class="container">
      <div class="row">
         <div class="container">
            {% with messages = get_flashed_messages() %}
            {% if messages %}
            {% for message in messages %}
            <p>{{ message }}</p>
            {% endfor %}
            {% endif %}
            {% endwith %}
         </div>
      </div>
      <h2 class="your-posts-header">Your Posts</h2>
      <div class="table-responsive">
         <table class="table table-striped table-sm">
            <thead>
               <tr class="table-row">
                  <th>#</th>
                  <th>Image</th>
                  <th>Title</th>
                  <th>Date</th>
               </tr>
            </thead>
            <tbody>
               {% for post in posts %}
               <tr class="table-text">
                  <td>{{ loop.index }}.</td>
                  <td><img src="{{ post.img_url }}" class="img-thumbnail small-image"></td>
                  <td><a href="{{ url_for('show_post', post_id=post._id) }}">{{ post.title }}</a></td>
                  <td>{{ post.date }}</td>
                  <td><a class="btn btn-outline-secondary float-start"
                     href="{{ url_for('edit_post', post_id=post._id) }}">Edit Post
                     </a>
                  </td>
                  <td>
                     <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal"
                        data-bs-target="#delete{{ post._id }}">
                     Delete Post
                     </button>
                     <!-- MODAL -->
                     <div class="modal fade" id="delete{{ post._id }}" tabindex="-1" role="dialog"
                        aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                           <div class="modal-content">
                              <div class="modal-header">
                                 <h5 class="modal-title" id="exampleModalLongTitle">Are you sure you want to
                                    delete this post?
                                 </h5>
                                 <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                                 </button>
                              </div>
                              <div class="modal-footer">
                                 <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close
                                 </button>
                                 <a class="btn btn-outline-danger"
                                    href="{{ url_for('delete_post', post_id=post._id) }}">Delete Post
                                 </a>
                              </div>
                           </div>
                        </div>
                     </div>
                  </td>
               </tr>
               {% endfor %}
            </tbody>
         </table>
      </div>
   </div>
</main>
<br>
<hr>
{% include "footer.html" %}